<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <link rel='stylesheet' href='styles.css'/>
    <meta charset="utf-8">
    <title>Insulin Calculator</title>
  </head>

  <body>
    <div class="main">
      <h1>Insulin Calculator</h1>
      <p>Calculate insulin quantity from dosing instructions.</p>

      <div class="form">

        <div class='form-row'>
          <label for='quantity' class="calc-label">Quantity:</label>
          <input id='quantity' name='quantity' type='text' class="form-right" value=""/>
        </div>
   
        <!-- <div class='form-row'>
          <span class="calc-label">Measurement: </span>
          <div class="form-right">
            <input type="radio" name ="Measurement" id="Units" value="isUnits" checked="true">
            <label for='read'>Units</label>

            <input type="radio" name ="Measurement" id="Mgs" value="isMgs">
            <label for='read'>Mgs</label>
          </div>
        </div> -->

        <div class='form-row'>
          <span class="calc-label">Interval: </span>
          <div class="form-right">
            <input type="radio" name ="interval" id="Daily" value="isdaily" checked="true">
            <label for='Daily'>Daily</label>

            <input type="radio" name ="interval" id="Weekly" value="isweekly">
            <label for='Weekly'>Weekly</label>
          </div>
        </div>

        <div class='form-row'>
          <label for='days' class="calc-label">Days Supply:</label>
          <input id='days' name='days' type='text' class="form-right" value="90"/>
        </div>
      </div>

      <h2>Insulins</h2>

      <p id=buttons class="button-box"></p>

      <h2>Calculation</h2>

      <p id="result" class="result"></p>

      <p id="notes" class="result"></p>

</div>

    <script>

class Insulin {
        constructor(name, varname, quantity, unit, form, note) {
          this.name = name;
          this.varname = varname;
          this.quantity = quantity; //per unit
          this.unit = unit;
          this.form = form;
          this.note = note; //add additional notes like needle tips or pack sizes

          this.addToDom()
        }

        //add button to dom on creation?
        calculate = () => {
          let quantity = document.getElementById('quantity').value;
          let interval = document.getElementById('Daily').checked ? 1 : (1/7) 
          let days = document.getElementById('days').value;

          let result = document.getElementById('result');
          let total = ((quantity * days * interval) / this.quantity)
          result.textContent = Math.ceil(total) + " " + this.name + " " + this.form + "s"

          let notes = document.getElementById('notes');
          if (this.note) {
            notes.textContent = "Note: " + this.note;
          } else {
            notes.textContent = ""
          }
        } 

        addToDom = () => {
          const btn = document.createElement('input');
            btn.setAttribute('value', this.name);
            btn.setAttribute('id', this.name);
            btn.setAttribute('type', 'button');
            btn.setAttribute('class', 'btn');
            btn.setAttribute('onclick', this.varname + ".calculate()");
            document.getElementById('buttons').appendChild(btn)
        }

      }

      const humalog = new Insulin("Humalog Vial", "humalog", 350, "mg", "vial")
      const humalogpen = new Insulin("Humalog Kwikpen", "humalogpen", 300, "mg", "vial", "pls test")
      const trulicity = new Insulin("Trulicity 1.5/0.5", "trulicity", 1.5, "mg", "pen")
      const tresiba300 = new Insulin("Tresiba 300IU", "tresiba300", 300, "ml", "pen")
      const toujeo = new Insulin("Toujeo Solostar", "toujeo", 450, "ml", "pen", "Not the MAX version")
      const toujeomax = new Insulin("Toujeo Max Solostar", "toujeomax", 900, "ml", "pen")
      const novolog = new Insulin("Novolog Flexpen", "novolog", 300, "ml", "pen")
      const novologfill = new Insulin("Novolog Penfill", "novologfill", 300, "ml", "pen", "Note sure about this one")
      const novologvial = new Insulin("Novolog 10ml Vial", "novologvial", 1000, "ml", "pen", "This one needs testing")
      const levemir = new Insulin("Levemir Flextouch", "levemir", 300, "ml", "pen")
      const lantus = new Insulin("Lantus Solostar", "lantus", 300, "ml", "pen")

    </script>

  </body>
</html>
