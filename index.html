<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <link rel='stylesheet' href='styles.css'/>
    <meta charset="utf-8">
    <title>Insulin Calculator</title>
  </head>

  <body>
    <div class="main">
      <h1>Insulin Calculator</h1>
      <p>Calculate insulin quantity from dosing instructions.</p>

      <div class="form">

        <div class='form-row'>
          <label for='quantity' class="calc-label">Quantity:</label>
          <input id='quantity' name='quantity' type='text' class="form-right" value=""/>
        </div>
   
        <!-- <div class='form-row'>
          <span class="calc-label">Measurement: </span>
          <div class="form-right">
            <input type="radio" name ="Measurement" id="Units" value="isUnits" checked="true">
            <label for='read'>Units</label>

            <input type="radio" name ="Measurement" id="Mgs" value="isMgs">
            <label for='read'>Mgs</label>
          </div>
        </div> -->

        <div class='form-row'>
          <span class="calc-label">Interval: </span>
          <div class="form-right">
            <input type="radio" name ="interval" id="Daily" value="isdaily" checked="true">
            <label for='Daily'>Daily</label>

            <input type="radio" name ="interval" id="Weekly" value="isweekly">
            <label for='Weekly'>Weekly</label>
          </div>
        </div>

        <div class='form-row'>
          <label for='days' class="calc-label">Days Supply:</label>
          <input id='days' name='days' type='text' class="form-right" value="90"/>
        </div>
      </div>

      <h2>Insulins</h2>

      <p id=buttons class="button-box"></p>

      <h2>Calculation</h2>

      <div id="result" class="result">
        <div id="result-number" class="result-number"></div>
        <div id="result-rest" class="result-rest"></div>

      </div>

      <p id="notes" class="notes"></p>


</div>

    <script>

class Insulin {
        constructor(name, varname, quantity, unit, form, note, color) {
          this.name = name;
          this.varname = varname;
          this.quantity = quantity; //per unit
          this.unit = unit;
          this.form = form;
          this.note = note; //add additional notes like needle tips or pack sizes
          this.color = color ? color : "#FEFAE4";

          this.addToDom()
        }

        //add button to dom on creation?
        calculate = () => {
          let quantity = document.getElementById('quantity').value;
          let interval = document.getElementById('Daily').checked ? 1 : (1/7) 
          let days = document.getElementById('days').value;

          let resultNum = document.getElementById('result-number');
          let resultRest = document.getElementById('result-rest');
          let total = ((quantity * days * interval) / this.quantity)
          resultNum.textContent = Math.ceil(total)
          resultRest.textContent = this.name + " " + this.form + "s"

          let notes = document.getElementById('notes');
          if (this.note) {
            notes.textContent = "Note: " + this.note;
          } else {
            notes.textContent = ""
          }
        } 

        addToDom = () => {
          const btn = document.createElement('input');
            btn.setAttribute('value', this.name);
            btn.setAttribute('id', this.name);
            btn.setAttribute('type', 'button');
            btn.setAttribute('class', 'btn');
            btn.setAttribute('onclick', this.varname + ".calculate()");
            btn.style.backgroundColor = this.color;
            document.getElementById('buttons').appendChild(btn)
        }

      }

      const humalog = new Insulin("Humalog Vial", "humalog", 1000, "mg", "vial", "", "#E3FEC8")
      const humalogpen = new Insulin("Humalog Kwikpen", "humalogpen", 300, "mg", "vial", "pls test", "#E3FEC8")
      const trulicity = new Insulin("Trulicity 1.5/0.5", "trulicity", 1.5, "mg", "pen", 'Boxes of 4 - usually need 3 boxes (12 pens)', "#FAC1C1")
      const trulicitysmall = new Insulin("Trulicity 0.75/0.5", "trulicitysmall", 0.75, "mg", "pen", 'Boxes of 4 - usually need 3 boxes (12 pens)', "#FAC1C1")
      const toujeo = new Insulin("Toujeo Solostar", "toujeo", 450, "ml", "pen", "Not the MAX version", "#F6E9FD")
      const toujeomax = new Insulin("Toujeo Max Solostar", "toujeomax", 900, "ml", "pen", "there is also non-Max version", "#F6E9FD")
      const novolog = new Insulin("Novolog Flexpen", "novolog", 300, "ml", "pen", '', "#C4F1F1")
      const novologfill = new Insulin("Novolog Penfill", "novologfill", 300, "ml", "pen", "pls test", "#C4F1F1")
      const novologvial = new Insulin("Novolog 10ml Vial", "novologvial", 1000, "ml", "pen", "pls test", "#C4F1F1")
      const tresiba300 = new Insulin("Tresiba 300IU", "tresiba300", 300, "ml", "pen", "There is also 300IU version", "#f9f9f9")
      const tresiba600 = new Insulin("Tresiba 600IU", "tresiba600", 600, "ml", "pen", "There is also 300IU version", "#f9f9f9")
      const levemir = new Insulin("Levemir Flextouch", "levemir", 300, "ml", "pen")
      const lantus = new Insulin("Lantus Solostar", "lantus", 300, "ml", "pen")
      const basaglar = new Insulin("Basaglar Kwikpen", "basaglar", 300, "ml", "pen")
      const victoza = new Insulin("Victoza", "victoza", 18, "ml", "pen")
      const Humira = new Insulin("Humira", "Humira", 40, "ml", "pen", "suuuuper untested")

    </script>

  </body>
</html>
